<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VSC Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
<style>
body{
  margin:0; font-family:"Poppins",sans-serif; background:linear-gradient(135deg, #0a0019, #000a1e); color:#eaffff; text-align:center;
}
.container{ margin:14px; padding:22px; border-radius:26px; background:rgba(8,8,20,.65); border:1px solid rgba(0,255,255,.25); }
h1,h2,h3,h4{ margin:0; text-align:center; }
h1{ font-family:"Playfair Display",serif; letter-spacing:3px; margin-bottom:10px;}
h2{ font-size:14px; color:#9befff; margin-bottom:10px;}
input, select, textarea{ width:100%; padding:10px; margin-bottom:12px; border-radius:8px; background:#000; color:#eaffff; border:1px solid #00eaff; font-size:16px; box-sizing:border-box;}
textarea{ resize:none;}
button{ width:100%; padding:12px; border-radius:28px; border:none; cursor:pointer; background:linear-gradient(120deg,#ff00cc,#00eaff,#ff00cc); background-size:200% 100%; color:#000; font-weight:bold; margin-bottom:10px; transition:0.3s;}
button:hover{ background-position:100% 0; transform:translateY(-2px);}
.menu-btns{ display:flex; justify-content:center; gap:12px; flex-wrap:wrap; margin-top:20px; z-index:10; }
.log{margin-top:20px;}
.log-table{ max-height:250px; overflow-y:auto; border-top:1px solid rgba(0,255,255,.25);}
.log-row{ display:grid; grid-template-columns:40px 100px 80px 90px 80px 80px 140px; gap:6px; padding:8px; font-size:12px; border-bottom:1px solid rgba(0,255,255,.15);}
.log-head{ font-weight:bold; color:#9befff; position:sticky; top:0; background:#000;}
.status{ display:flex; justify-content:center; align-items:center;}
.status.present::before{content:"âœ”";color:#00ff99}
.status.absent::before{content:"âœ–";color:#ff4d4d}
</style>
</head>
<body>
<div class="container">
  <h1>VELOCITY SOCIETY CLUB</h1>
  <h2 id="welcomeMsg" style="min-height:60px;"></h2>

  <!-- Menu -->
  <div class="menu-btns" id="menuBtns" style="display:none;">
    <button onclick="chooseActivity('attendance')">Attendance</button>
    <button onclick="chooseActivity('fillup')">Fill Up Form</button>
  </div>

  <!-- Attendance Section -->
  <div id="attendanceSection" style="display:none;">
    <label>NAME</label><input id="name">
    <label>CPM ID</label><input id="cpm">
    <label>DATE</label><input id="date" readonly>
    <label>TIME</label><input id="time" readonly>
    <label>ABSENT</label><input id="absent" placeholder="YES if absent">
    <label>REASON</label><input id="reason">
    <button onclick="confirmEntry()">CONFIRM</button>

    <div class="log">
      <div style="text-align:center;margin-bottom:12px">
        <h3 id="countDisplay">0 / 0 Members</h3>
        <h4 id="rateDisplay"></h4>
      </div>
      <div id="absentBox" style="margin-bottom:12px">
        <strong>ABSENT MEMBERS:</strong>
        <ul id="absentList" style="font-size:13px;margin-top:6px"></ul>
      </div>
      <h3>LIVE LOG</h3>
      <div class="log-table">
        <div class="log-row log-head">
          <div></div><div>NAME</div><div>CPM</div><div>DATE</div><div>TIME</div><div>ABSENT</div><div>REASON</div>
        </div>
        <div id="logList"></div>
      </div>
      <button style="margin-top:12px" onclick="resetRecords()">RESET (ADMIN)</button>
    </div>
  </div>

  <!-- Fill Up Form -->
  <div id="fillupSection" style="display:none;">
    <div style="text-align:center;margin-bottom:12px;">
      <img loading="lazy" src="logo.png" alt="Club Logo" width="120">
      <h2>Join Velocity Society Club</h2>
    </div>
    <label>Name</label><input id="fName" type="text">
    <label>Age</label>
    <select id="fAge"><option value="">Select Age</option></select>
    <label>CPM ID</label><input id="fCpm" type="text">
    <label>IGN</label><input id="fIgn" type="text">
    <label>Role</label>
    <select id="fRole">
      <option value="">Select Role</option>
      <option value="Photographer">Photographer</option>
      <option value="Videographer">Videographer</option>
      <option value="Editor">Editor</option>
      <option value="Event Manager">Event Manager</option>
    </select>
    <label>Club Before & Reason</label><textarea id="fReason" rows="3"></textarea>
    <label>Upload Image</label><input id="fImage" type="file" accept="image/*">
    <button onclick="submitFillupForm()">Submit</button>
  </div>
</div>

<script>
// ===== Fill Age Dropdown =====
for(let i=17;i<=50;i++){
  const option = document.createElement("option");
  option.value = i; option.text = i;
  document.getElementById("fAge").appendChild(option);
}

// ===== Smooth Typing =====
const welcomeText = "Hi! I'm your assistant for today to guide you through the Velocity Society Club dashboard. Please choose your activity below.";
const display = document.getElementById("welcomeMsg");
let i=0;
function typeWriter(){
  if(i < welcomeText.length){
    display.innerHTML += welcomeText.charAt(i);
    i++;
    let delay = 25;
    if(",.".includes(welcomeText.charAt(i-1))) delay=150;
    setTimeout(typeWriter, delay);
  } else {
    document.getElementById("menuBtns").style.display="flex";
  }
}
window.onload = typeWriter;

// ===== Menu Activity =====
function chooseActivity(act){
  if(act==="attendance"){
    const userCpm = prompt("Enter your CPM ID to access Attendance:");
    // Fake members check for testing, replace with import from member.js
    const members = [{cpm:"1234", name:"Antonette"}]; 
    const isMember = members.some(m=>m.cpm===userCpm);
    if(!isMember){ alert("You are not a member. Please choose the correct activity."); return; }
    document.getElementById("attendanceSection").style.display="block";
    document.getElementById("fillupSection").style.display="none";
  } else if(act==="fillup"){
    document.getElementById("fillupSection").style.display="block";
    document.getElementById("attendanceSection").style.display="none";
  }
}

// ===== Attendance Auto Date/Time =====
const dateInput = document.getElementById("date");
const timeInput = document.getElementById("time");
setInterval(()=>{
  if(dateInput) dateInput.value = new Date().toISOString().slice(0,10);
  if(timeInput) timeInput.value = new Date().toTimeString().slice(0,8);
},1000);

// ===== Fill Up Form submit to Telegram =====
function submitFillupForm(){
  const name = document.getElementById("fName").value.trim();
  const age  = document.getElementById("fAge").value;
  const cpm  = document.getElementById("fCpm").value.trim();
  const ign  = document.getElementById("fIgn").value.trim();
  const role = document.getElementById("fRole").value;
  const reason = document.getElementById("fReason").value.trim();
  const imageFile = document.getElementById("fImage").files[0];
  if(!name || !age || !cpm || !ign || !role || !reason || !imageFile){ return alert("Please fill all fields and upload an image."); }

  const BOT_TOKEN = "YOUR_BOT_TOKEN_HERE"; // replace
  const CHAT_ID   = "YOUR_CHAT_ID_HERE";   // replace

  const caption = `ðŸ“Œ New Club Registration
*Name:* ${name}
*Age:* ${age}
*CPM ID:* ${cpm}
*IGN:* ${ign}
*Role:* ${role}
*Reason:* ${reason}`;

  const formData = new FormData();
  formData.append("chat_id", CHAT_ID);
  formData.append("photo", imageFile);
  formData.append("caption", caption);
  formData.append("parse_mode","Markdown");

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{method:"POST",body:formData})
  .then(()=>{ alert("Thank you for joining! Please wait for approval.");
    ["fName","fAge","fCpm","fIgn","fRole","fReason","fImage"].forEach(id=>document.getElementById(id).value="");})
  .catch(err=>{ console.error(err); alert("Failed to send data. Try again."); });
}
</script>
</body>
</html>
